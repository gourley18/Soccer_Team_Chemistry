This code was written by Cody Arvonen. 